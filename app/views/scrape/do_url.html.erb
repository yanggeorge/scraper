<% if @is_error %>
    <br/>
    <%= @error_content %>
<% else %>

    <%= javascript_tag do %>
        window.ym.robot_string = '<%= @robot_string.html_safe %>'
    <% end %>
    <style id="ace_editor">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}</style>

    <div class="p1" >
      <div id="p0" class="p2-1 main">
        <div class="loader" data-loading>
          <span>Please wait while processing step...</span>

          <div class="spinner-container">
            <div class="sk-spinner sk-spinner-rotating-plane"></div>
          </div>

          <ul class="details ng-hide" ng-show="idleStates.length">
            <li>Waiting for:</li>
            <!-- ngRepeat: idleState in idleStates -->
          </ul>

          <a class="button big danger" ng-click="player.abort()">Abort execution</a>

        </div>
        <div id="p2" class="p3-1 sidepane">
          <div class="content">
            <h3>
              <span ng-bind="sidepane1_title"></span>

              <div class="actions">
                <a href="javascript:;" ng-click="closeSidePane1()" class="button mini">
                  <i class="fa fa-remove"></i>
                </a>
              </div>
            </h3>
            <div class="body" ng-include="sidepane1_view">

            </div>
          </div>
        </div>
        <div id="p1" class="p3-2 page" ng-controller="MarkerCtrl" >
          <div id="p1-inner" class="p4-1 inner"   >
            <div class="marker-container"  >
                <div class="container scroll"  >
                  <!-- 在这个元素下添加 selected div-->
                  <div class="scroller" ng-style="{height:iframe_height,width:iframe_width}"></div>
                  <!--<div style="top:362px;left:237px;width:710px;height:30px;right:947px;bottom:392px" class="marker selected suggestion"></div>-->
                </div>
            </div>
            <iframe id="modified_page" class="iframe_class" iframe-onload  >
            </iframe>
          </div>
        </div>
      </div>
      <div class="p2-2  mainpane">
        <div id="p4" class="p3-3 sidepane">
          <h3>
            <span ng-bind="sidePane2Title"></span>

            <div class="actions">
              <a href="javascript:;" ng-click="closeSidePane2()" class="button mini">
                <i class="fa fa-remove"></i>
              </a>
            </div>
          </h3>
          <div class="body" ng-include="sidePaneView2">

          </div>
        </div>
        <div id="p3" class="p3-4 main tab-pane">
          <div class="tab-buttons">
            <a class="button active" tab-id="steps">Steps<i class="fa fa-chevron-down collapsed"></i></a>
            <a class="button " tab-id="Elements">Elements<i class="fa fa-chevron-down collapsed"></i></a>
            <a class="button " tab-id="Outputs">Outputs<i class="fa fa-chevron-down collapsed"></i></a>
            <a class="button " tab-id="Results">Results<i class="fa fa-chevron-down collapsed"></i></a>
            <a class="button " tab-id="new">new<i class="fa fa-chevron-down collapsed"></i></a>

            <div class="actions">
              <a class="button small t orange" ng-click="contactSupport()" title="Write a message to support">
                Get help
              </a>

              <i class="separator"></i>

              <a class="button small t" ng-click="goBack()">
                Close
              </a>

              <a ng-show="draft.exists" class="button danger small t" ng-click="discardDraft()"
                 ng-confirm="This will cause all current changes to be lost. Continue?">
                Discard draft
              </a>

              <a class="button small t" ng-click="jsonEditor.show()"
                 title="Edit the raw robot definition in JSON format">
                JSON
              </a>

              <a class="button primary small t" ng-click="save()">
                Save
              </a>

              <i class="separator"></i>

              <a class="button mini" title="Restart" ng-click="player.restart()">
                <i class="fa fa-fast-backward"></i>
              </a>
              <a class="button mini" title="Step back" ng-click="player.stepBack()">
                <i class="fa fa-step-backward"></i>
              </a>
              <a class="button mini" title="Step forward" ng-click="player.stepForward()">
                <i class="fa fa-step-forward"></i>
              </a>
              <a class="button mini" title="Start / stop" ng-click="player.togglePlay()"
                ng-class="{secondary : player.playing}">
                <i ng-class="{fa : true, 'fa-play': !player.playing, 'fa-pause':player.playing}"></i>
              </a>
            </div>
          </div>
          <div class="tab-page fill padded active">
            <div class="flow-editor" style="top:2px; left:10px;overflow:hidden; z-index:2;">
              <svg width="{{svg_width}}" height="222" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
                <g>
                  <title>Layer 1</title>
                  <g id="svg_7" class="line-weight:22px;" ng-include="'svg.html'">
                  </g>
                </g>
              </svg>

              <div  ng-repeat="node in nodes" title="{{node.desc}}" ng-class="node.style" ng-style="node.position" style="position:absolute;" class="flow-step tst-robot-scraper-devtools-timeline-step ng-scope  active " >
                <div class="title-container"  ng-click="clickNode(node);$event.stopPropagation();">
                  <div class="title">{{node.title}}</div>
                </div>
                <div class="step-adder after" ng-click="addStepAfter(node);$event.stopPropagation();" >
                  <i class="fa fa-plus" ></i>
                </div>
                <div class="step-adder before" ng-click="addStepBefore(node);$event.stopPropagation();">
                  <i class="fa fa-plus"></i>
                </div>
              </div>


            </div>
          </div>
          <div class="tab-page fill padded ">
            <div class="dom-view">
              <ul class="dom-root">
                <li class="opened">
                  <a class="dom-tag-start-toggle" rel="html"><i class="fa dom-folded-closed fa-chevron-down"></i></a><a class="dom-tag-start"><span class="dom-tag-start-name">&lt;html</span><span class="dom-attr"> <span class="dom-attr-name">xmlns</span>=<span class="dom-attr-value">"http://www.w3.org/1999/xhtml"</span></span><span class="dom-tag-start-end">&gt;</span></a><span class="dom-folded" style="display: none;">...</span>
                  <ul class="dom-content" style="display: block;">
                    <li class="">
                      <a class="dom-tag-start-toggle" rel="head"><i class="fa dom-folded-closed fa-chevron-right"></i></a><a class="dom-tag-start"><span class="dom-tag-start-name">&lt;head</span><span class="dom-tag-start-end">&gt;</span></a><span class="dom-folded" style="display: inline;">...</span>
                      <ul class="dom-content" style="display: none;"></ul>
                      <span class="dom-tag-end">&lt;/head&gt;</span></li>

                    <li class="opened">
                      <a class="dom-tag-start-toggle" rel="body"><i class="fa dom-folded-closed fa-chevron-down"></i></a><a class="dom-tag-start"><span class="dom-tag-start-name">&lt;body</span><span class="dom-attr"> <span class="dom-attr-name">style</span>=<span class="dom-attr-value">"background: url(../../images/stbybg.jpg) no-repeat scroll center top #FFFFFF;"</span></span><span class="dom-attr"> <span class="dom-attr-name">class</span></span><span class="dom-tag-start-end">&gt;</span></a><span class="dom-folded" style="display: none;">...</span>
                      <ul class="dom-content" style="display: block;">
                        <li>
                          <a class="dom-tag-start-toggle" rel="div"><i class="fa fa-chevron-right dom-folded-closed"></i></a><a class="dom-tag-start"><span class="dom-tag-start-name">&lt;div</span><span class="dom-attr"> <span class="dom-attr-name">class</span>=<span class="dom-attr-value">"wrapper"</span></span><span class="dom-tag-start-end">&gt;</span></a><span class="dom-folded">...</span>
                          <ul class="dom-content"></ul>
                          <span class="dom-tag-end">&lt;/div&gt;</span></li>


                        <li>
                          <a class="dom-tag-start-toggle" rel="a"><i class="fa fa-chevron-right dom-folded-closed"></i></a><a class="dom-tag-start"><span class="dom-tag-start-name">&lt;a</span><span class="dom-tag-start-end">&gt;</span></a><span class="dom-folded">...</span>
                          <ul class="dom-content"></ul>
                          <span class="dom-tag-end">&lt;/a&gt;</span></li>
                        <li>
                          <a class="dom-tag-start-toggle" rel="style"><i class="fa fa-chevron-right dom-folded-closed"></i></a><a class="dom-tag-start"><span class="dom-tag-start-name">&lt;style</span><span class="dom-attr"> <span class="dom-attr-name">style</span>=<span class="dom-attr-value">"true"</span></span><span class="dom-tag-start-end">&gt;</span></a><span class="dom-folded">...</span>
                          <ul class="dom-content"></ul>
                          <span class="dom-tag-end">&lt;/style&gt;</span></li>
                      </ul>
                      <span class="dom-tag-end">&lt;/body&gt;</span></li>
                  </ul>
                  <span class="dom-tag-end">&lt;/html&gt;</span></li>
              </ul>
            </div>
          </div>

          <div class="tab-page fill padded " ng-controller="OutputsCtrl">
            <!-- Outputs -->
            <form ng-controller="fieldsCtrl" class="robot-field-list label-above ng-pristine ng-valid ng-scope ng-valid-fieldisuniquevalue ng-valid-required ng-valid-pattern">
              <div ng-repeat="field in outputFields" class="robot-field form-row-line ng-scope" ng-controller="fieldCtrl">
                <div class="actions">
                  <a href="javascript:;" class="button mini danger" ng-click="remove(outputFields, field)">
                    <i class="fa fa-times"></i>
                  </a>
                  <a ng-hide="$first" href="javascript:;" class="button mini ng-hide" ng-click="move(outputFields, field, -1)">
                    <i class="fa fa-arrow-up"></i>
                  </a>
                  <a ng-hide="$last" href="javascript:;" class="button mini" ng-click="move(outputFields, field, 1)">
                    <i class="fa fa-arrow-down"></i>
                  </a>
                </div>

                <div class="form-row" label="Field name"><label class="field-label">Field name:</label>
                  <input  ng-pattern="'[a-zA-Z_][a-zA-Z 0-9-_]*'" ng-model-options="{allowInvalid:false}" ng-blur="checkForChange()" required="true" name="fieldId" type="text" ng-model="field.id" placeholder="Field #1" class="ng-pristine ng-untouched ng-valid ng-valid-fieldisuniquevalue ng-valid-required ng-valid-pattern">
                  <div class="help" title="Must start with a letter or underscore and only contain letters, numbers, spaces, dashes (-) and underscores (_) after the first letter">
                    Must match: [a-zA-Z_][a-zA-Z 0-9-_]*
                  </div>
                  <div class="error" style="display: none;"></div></div>

                <div class="form-row" label="Field type"><label class="field-label">Field type:</label>
                  <select required="true" ng-model="field.type" name="fieldType" ng-options="type as name for (type,name) in fieldTypes" class="ng-pristine ng-untouched ng-valid ng-valid-required"><option value="" class="t">Select field type...</option><option value="boolean" label="True / False">True / False</option><option value="number" selected="selected" label="Number">Number</option><option value="string" label="Text">Text</option></select>
                  <div class="error" style="display: none;"></div></div>

                <div   class="form-row ng-scope" label="Default value" help="This value will be used if no valid value is provided.">
                  <label class="field-label">Default value:</label>
                  <input  name="defaultValue" auto-field="field" ng-model="field.defaultValue" class="ng-pristine ng-untouched ng-valid auto" style="display: none;">
                  <input ng-if="!is_boolean(field.type)" type="{{field.type}}" ng-model="field.default_value" style="" class="auto ng-pristine ng-untouched ng-valid ng-scope">
                  <div ng-if="is_boolean(field.type)" style="display:inline-block" class="ng-scope">
                    <label style="width:auto; margin-right:10px;"><input type="radio" value="true" ng-model="field.default_value" style="" class="auto ng-pristine ng-untouched ng-valid" name="548"> True</label>
                    <label style="width:auto;"><input type="radio" value="false" checked="checked" ng-model="field.default_value" style="" class="auto ng-pristine ng-untouched ng-valid" name="549"> False</label>
                  </div>
                  <div class="help">This value will be used if no valid value is provided.</div>
                  <div class="error" style="display: none;"></div>
                </div>

              </div>
            </form>
            <a class="button secondary" href="javascript:;" ng-click="addOutputField()">
              <i class="fa fa-plus"></i>
              Add field
            </a>
          </div>

          <div class="tab-page fill padded " ng-controller="resultsCtrl">
            <div class="box info ng-hide" ng-hide="outputFields.length > 0">
              You need to add output fields to see a result preview. Add output fields by going to the outputs tab.
            </div>
            <div ng-show="outputFields.length > 0" class="">
              <div>
                <button class="button" ng-click="resetOutput()">Reset results</button>

              </div>

              <!--<div class="box error margin-above ng-binding ng-hide" ng-show="formatterError">Output formatting failed: </div>-->

              <table class="results">
                <tr>
                  <th ng-repeat="field in formattedOutput.header track by $index" ng-bind="field" class="ng-binding ng-scope">

                  </th>
                </tr>
                <tr ng-repeat="row in formattedOutput.rows track by $index" class="ng-scope">
                  <td ng-repeat="value in row.data track by $index" ng-bind="value" class="ng-binding ng-scope">
                  </td>
                </tr>
              </table>
            </div>
          </div>
          <div class="tab-page fill padded ">
            new <br>
            <input onclick="toggle();return false;" value="sidepane1" type="button">
            <input onclick="toggle_sidepane2();return false;" value="sidepane2" type="button">
          </div>

        </div>
      </div>
    </div>

    <div id="dialog" class="jsoneditor" dialog-title="Edit robot definition" ng-show="jsonEditor.visible"
        style="display: block;width: auto;min-height: 71px;max-height: 799px;height: auto;">
      <form class="label-above ng-pristine ng-valid">
        <div class="form-row jsonfield" label="Robot definition"><label class="field-label">Robot definition:</label>
          <pre  id="editor" class="javascript-editor ace_editor ace-xcode"></pre>
        </div>
        <a class="button" href="javascript:;" ng-click="jsonEditor.save()">Save</a>
        <a class="button" href="javascript:;" ng-click="jsonEditor.cancel()">Cancel</a>
      </form>
    </div>

<% end %>
